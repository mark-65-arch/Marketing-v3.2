# ============================================================================
# .htaccess Configuration for Hostinger Deployment
# Marketing AI Houston - Static Astro Site
# ============================================================================
#
# This file provides Apache HTTP Server configuration including:
# - Content Security Policy (CSP) headers
# - Security headers (XSS, clickjacking protection)
# - Cache control for performance
# - HTTPS redirect
#
# Note: If Hostinger supports _headers file (Netlify/Vercel format),
#       this .htaccess may not be needed. Use one or the other, not both.
# ============================================================================

<IfModule mod_headers.c>
    # ========================================================================
    # Content Security Policy (CSP)
    # ========================================================================
    # This CSP allows:
    # - Scripts from self, GTM, Calendly, Google Ads
    # - Styles from self (inline allowed for Tailwind CSS)
    # - Images from self, data URIs, and HTTPS sources
    # - Connections to analytics and form APIs
    # - Iframes from Calendly and Google Docs
    # - Prevents clickjacking with frame-ancestors 'self'

    Header set Content-Security-Policy "default-src 'self'; script-src 'self' https://calendly.com https://www.googletagmanager.com https://googleads.g.doubleclick.net https://www.google.com https://www.gstatic.com; style-src 'self' 'unsafe-inline' https://www.google.com; font-src 'self'; img-src 'self' data: https:; connect-src 'self' https://usebasin.com https://www.google-analytics.com https://www.googletagmanager.com https://www.google.com https://www.googleadservices.com https://docs.google.com; frame-src https://calendly.com https://docs.google.com; frame-ancestors 'self';"

    # ========================================================================
    # Security Headers
    # ========================================================================

    # Prevent clickjacking by disallowing iframe embedding
    Header set X-Frame-Options "DENY"

    # Prevent MIME-type sniffing
    Header set X-Content-Type-Options "nosniff"

    # Control referrer information
    Header set Referrer-Policy "strict-origin-when-cross-origin"

    # Disable browser features that could be security risks
    Header set Permissions-Policy "camera=(), microphone=(), geolocation=()"

    # ========================================================================
    # Performance: Cache Control Headers
    # ========================================================================

    # Static assets with hashed filenames - cache immutably for 1 year
    <FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico|woff|woff2|ttf|css|js)$">
        Header set Cache-Control "public, max-age=31536000, immutable"
    </FilesMatch>

    # HTML pages - short cache with revalidation
    <FilesMatch "\.(html|htm)$">
        Header set Cache-Control "public, max-age=0, must-revalidate"
    </FilesMatch>

    # Manifest and service workers - no cache
    <FilesMatch "\.(webmanifest|json)$">
        Header set Cache-Control "public, max-age=0, must-revalidate"
    </FilesMatch>
</IfModule>

# ============================================================================
# HTTPS Redirect (Recommended for Production)
# ============================================================================
# Uncomment the following lines to force HTTPS on production:

# <IfModule mod_rewrite.c>
#     RewriteEngine On
#     RewriteCond %{HTTPS} off
#     RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
# </IfModule>

# ============================================================================
# Error Pages (Optional)
# ============================================================================
# Uncomment to use custom error pages:

# ErrorDocument 404 /404.html
# ErrorDocument 500 /500.html

# ============================================================================
# Compression (Performance)
# ============================================================================
# Enable GZIP compression for better performance

<IfModule mod_deflate.c>
    # Compress HTML, CSS, JavaScript, Text, XML
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/x-javascript application/json application/xml
</IfModule>

# ============================================================================
# Browser Caching (Alternative to Cache-Control headers above)
# ============================================================================
# If Cache-Control headers don't work, try Expires headers:

# <IfModule mod_expires.c>
#     ExpiresActive On
#     # Images
#     ExpiresByType image/jpeg "access plus 1 year"
#     ExpiresByType image/png "access plus 1 year"
#     ExpiresByType image/webp "access plus 1 year"
#     ExpiresByType image/svg+xml "access plus 1 year"
#     # CSS and JavaScript
#     ExpiresByType text/css "access plus 1 year"
#     ExpiresByType application/javascript "access plus 1 year"
#     # Fonts
#     ExpiresByType font/woff "access plus 1 year"
#     ExpiresByType font/woff2 "access plus 1 year"
#     ExpiresByType font/ttf "access plus 1 year"
#     # HTML
#     ExpiresByType text/html "access plus 0 seconds"
# </IfModule>
