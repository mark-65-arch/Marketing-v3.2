---
// ü¶∂ Footer Component
// Purpose: Site-wide footer with contact info, links, and trust signals
// Features: Responsive layout, proper link structure, business information

interface Props {
  showNewsletter?: boolean;
  currentLang?: string;
}

const {
  showNewsletter = false,
  currentLang = 'en'
} = Astro.props;

// Determine if we're on a Spanish page
const isSpanish = currentLang === 'es';
const langPrefix = isSpanish ? 'es/' : '';

// üìû Contact information
const contactInfo = {
  phone: '(281) 544-0572',
  email: 'team@marketingaihouston.com',
  address: 'Houston, TX',
  businessHours: 'Mon-Fri 9AM-6PM CT'
};

// üîó Footer navigation links
const footerLinks = {
  quickLinks: [
    { href: `${import.meta.env.BASE_URL}${langPrefix}`, label: isSpanish ? 'Inicio' : 'Home' },
    { href: '#services', label: isSpanish ? 'Servicios' : 'Services' },
    { href: '#pricing', label: isSpanish ? 'Precios' : 'Pricing' },
    { href: '#faq', label: 'FAQ' },
    { href: `${import.meta.env.BASE_URL}${langPrefix}contact`, label: isSpanish ? 'Contacto' : 'Contact' }
  ],
  legal: [
    { href: `${import.meta.env.BASE_URL}${langPrefix}legal/terms-of-service`, label: isSpanish ? 'T√©rminos de Servicio' : 'Terms of Service' },
    { href: `${import.meta.env.BASE_URL}${langPrefix}legal/privacy-policy`, label: isSpanish ? 'Pol√≠tica de Privacidad' : 'Privacy Policy' },
    { href: `${import.meta.env.BASE_URL}${langPrefix}legal/cookie-policy`, label: isSpanish ? 'Pol√≠tica de Cookies' : 'Cookie Policy' },
    { href: `${import.meta.env.BASE_URL}${langPrefix}legal/accessibility-statement`, label: isSpanish ? 'Declaraci√≥n de Accesibilidad' : 'Accessibility Statement' },
    { href: `${import.meta.env.BASE_URL}${langPrefix}legal/copyright-notice`, label: isSpanish ? 'Aviso de Derechos de Autor' : 'Copyright Notice' }
  ],
  services: [
    { label: isSpanish ? 'Dise√±o Web' : 'Website Design' },
    { label: isSpanish ? 'SEO Local' : 'Local SEO' },
    { label: isSpanish ? 'Perfil de Google Business' : 'Google Business Profile' },
    { label: isSpanish ? 'Optimizaci√≥n de B√∫squeda por Voz' : 'Voice Search Optimization' }
  ]
};

// üèÜ Trust signals and certifications
const trustSignals = [
  { icon: 'fab fa-google', label: isSpanish ? 'Socios de Google' : 'Google Partners' },
  { icon: 'fas fa-search', label: isSpanish ? 'Certificado en SEO' : 'SEO Certified' },
  { icon: 'fas fa-mobile-alt', label: isSpanish ? 'M√≥vil Primero' : 'Mobile-First' },
  { icon: 'fas fa-robot', label: isSpanish ? 'Preparado para IA' : 'AI-Ready' }
];
---

<!-- ü¶∂ Main Site Footer -->
<footer class="bg-slate-900 text-white" role="contentinfo" aria-label="Site footer">
  <div class="container mx-auto px-4">

    <!-- üì¨ Newsletter Signup (Optional) -->
    {showNewsletter && (
      <div class="py-12 border-b border-gray-800">
        <div class="max-w-2xl mx-auto text-center">
          <h3 class="text-2xl font-bold mb-4">Stay Updated</h3>
          <p class="text-gray-400 mb-6">Get tips, insights, and updates for growing your business online.</p>

          <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto" aria-label="Newsletter signup">
            <label class="sr-only" for="newsletter-email">Email address</label>
            <input
              type="email"
              id="newsletter-email"
              name="email"
              placeholder="Enter your email"
              class="flex-1 px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none text-white placeholder-gray-400"
              required
              aria-describedby="newsletter-description"
            />
            <button
              type="submit"
              class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold transition-colors duration-200 focus:ring-4 focus:ring-blue-200"
              aria-label="Subscribe to newsletter"
            >
              Subscribe
            </button>
          </form>
          <p id="newsletter-description" class="text-xs text-gray-500 mt-3">
            No spam. Unsubscribe anytime. See our <a href="#privacy" class="text-blue-400 hover:text-blue-300">Privacy Policy</a>.
          </p>
        </div>
      </div>
    )}

    <!-- üìã Main Footer Content -->
    <div class="py-12">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 md:gap-10 lg:gap-12">

        <!-- üè† Brand & Contact -->
        <div class="md:col-span-1">
          <!-- Brand -->
          <div class="flex items-center mb-6" role="img" aria-label="Marketing AI Houston">
            <img
              src={`${import.meta.env.BASE_URL}leaning-leaf.png`}
              alt="Marketing AI Houston logo"
              width="40"
              height="40"
              class="w-10 h-10 mr-3"
            />
            <span class="font-bold text-lg">Marketing AI Houston</span>
          </div>

          <!-- Mission Statement -->
          <p class="text-gray-400 mb-6 leading-relaxed">
            {isSpanish
              ? 'Dise√±o web y SEO impulsado por IA ayudando a peque√±as empresas a ser encontradas en l√≠nea y crecer.'
              : 'AI-powered web design & SEO helping small businesses get found online and grow.'
            }
          </p>

          <!-- Primary CTA -->
          <a
            href={`${import.meta.env.BASE_URL}${langPrefix}contact#contact-options`}
            class="inline-flex items-center justify-center gap-1 bg-gradient-to-r from-blue-600 to-teal-600 hover:from-blue-700 hover:to-teal-700 text-white font-semibold py-3 px-6 rounded-full transition-all duration-300 transform hover:scale-105 shadow-lg focus:ring-4 focus:ring-blue-200 whitespace-nowrap"
            aria-label={isSpanish ? 'Reserva una llamada de descubrimiento gratuita' : 'Book a free discovery call'}
          >
            <span class="flex items-center gap-1">
              üìû {isSpanish ? 'Reserva ' : 'Book a '}
              <span class="bg-yellow-400 text-black px-2 py-1 rounded font-bold">{isSpanish ? 'GRATIS' : 'FREE'}</span>
              {isSpanish ? ' Llamada' : ' Call'}
            </span>
          </a>
        </div>

        <!-- üîó Quick Links -->
        <div>
          <h3 class="text-lg font-bold mb-6">{isSpanish ? 'Enlaces R√°pidos' : 'Quick Links'}</h3>
          <nav aria-label="Footer navigation">
            <ul class="space-y-3">
              {footerLinks.quickLinks.map(link => (
                <li>
                  <a
                    href={link.href}
                    class="text-gray-400 hover:text-white transition-colors duration-200 focus:text-white"
                  >
                    {link.label}
                  </a>
                </li>
              ))}
            </ul>
          </nav>
        </div>

        <!-- üìû Contact Information -->
        <div>
          <h3 class="text-lg font-bold mb-6">{isSpanish ? 'Informaci√≥n de Contacto' : 'Contact Info'}</h3>
          <address class="not-italic space-y-3">
            <div class="flex items-start">
              <i class="fas fa-map-marker-alt text-blue-400 mt-1 mr-3 text-sm flex-shrink-0" aria-hidden="true"></i>
              <span class="text-gray-400">{contactInfo.address}</span>
            </div>
            <div class="flex items-start">
              <i class="fas fa-phone text-blue-400 mt-1 mr-3 text-sm flex-shrink-0" aria-hidden="true"></i>
              <a
                href={`tel:${contactInfo.phone.replace(/\D/g, '')}`}
                class="text-gray-400 hover:text-white transition-colors duration-200"
                aria-label={`Call us at ${contactInfo.phone}`}
              >
                {contactInfo.phone}
              </a>
            </div>
            <div class="flex items-start">
              <i class="fas fa-envelope text-blue-400 mt-1 mr-3 text-sm flex-shrink-0" aria-hidden="true"></i>
              <a
                href={`mailto:${contactInfo.email}`}
                class="text-gray-400 hover:text-white transition-colors duration-200 break-all text-sm"
                aria-label={`Email us at ${contactInfo.email}`}
              >
                {contactInfo.email}
              </a>
            </div>
            <div class="flex items-start">
              <i class="fas fa-clock text-blue-400 mt-1 mr-3 text-sm flex-shrink-0" aria-hidden="true"></i>
              <span class="text-gray-400">{contactInfo.businessHours}</span>
            </div>
          </address>
        </div>

        <!-- üèÜ Trust Signals -->
        <div>
          <h3 class="text-lg font-bold mb-6">{isSpanish ? 'Nuestra Experiencia' : 'Our Expertise'}</h3>
          <div class="space-y-3">
            {trustSignals.map(signal => (
              <div class="flex items-center">
                <i class={`${signal.icon} text-blue-400 mr-3 text-sm`} aria-hidden="true"></i>
                <span class="text-gray-400 text-sm">{signal.label}</span>
              </div>
            ))}
          </div>

          <!-- Service Areas -->
          <div class="mt-6">
            <p class="text-sm text-gray-500 leading-relaxed">
              {isSpanish
                ? 'Atendiendo con orgullo a peque√±as empresas en Houston, Texas y en todo el pa√≠s.'
                : 'Proudly serving small businesses in Houston, Texas and nationwide.'
              }
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- üìÑ Legal & Copyright -->
    <div class="border-t border-gray-800 py-8">
      <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center space-y-6 lg:space-y-0 gap-6">

        <!-- Copyright -->
        <div class="text-center lg:text-left w-full lg:w-auto">
          <p class="text-gray-400 text-sm">
            ¬© {new Date().getFullYear()} Marketing AI Houston. All rights reserved.
          </p>
        </div>

        <!-- Legal Links -->
        <nav aria-label="Legal links" class="w-full lg:w-auto">
          <div class="flex flex-wrap justify-center lg:justify-end gap-x-4 gap-y-2 text-center lg:text-right">
            {footerLinks.legal.map((link, index) => (
              <>
                <a
                  href={link.href}
                  class="text-gray-400 hover:text-white text-sm transition-colors duration-200 focus:text-white whitespace-nowrap"
                >
                  {link.label}
                </a>
                {index < footerLinks.legal.length - 1 && (
                  <span class="text-gray-600" aria-hidden="true">|</span>
                )}
              </>
            ))}
          </div>
        </nav>
      </div>
    </div>
  </div>
</footer>

<!-- üîô Back to Top Button -->
<button
  id="back-to-top"
  class="fixed bottom-8 right-8 w-12 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg opacity-0 pointer-events-none transition-all duration-300 z-40 focus:ring-4 focus:ring-blue-200"
  aria-label="Back to top"
  title="Back to top"
>
  <i class="fas fa-chevron-up" aria-hidden="true"></i>
</button>

<script>
  // üîô Back to Top Functionality
  document.addEventListener('DOMContentLoaded', () => {
    const backToTopButton = document.getElementById('back-to-top');

    if (backToTopButton) {
      // Show/hide button based on scroll position
      const toggleButton = () => {
        if (window.pageYOffset > 300) {
          backToTopButton.classList.remove('opacity-0', 'pointer-events-none');
          backToTopButton.classList.add('opacity-100');
        } else {
          backToTopButton.classList.add('opacity-0', 'pointer-events-none');
          backToTopButton.classList.remove('opacity-100');
        }
      };

      // Scroll to top function
      const scrollToTop = () => {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      };

      // Event listeners
      window.addEventListener('scroll', toggleButton);
      backToTopButton.addEventListener('click', scrollToTop);

      // Keyboard accessibility
      backToTopButton.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          scrollToTop();
        }
      });
    }
  });

  // üìß Newsletter form handling (if present)
  document.addEventListener('DOMContentLoaded', () => {
    const newsletterForm = document.querySelector('form[aria-label="Newsletter signup"]');

    if (newsletterForm) {
      newsletterForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(newsletterForm);
        const email = formData.get('email') as string;

        // Basic email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          alert('Please enter a valid email address.');
          return;
        }

        try {
          // üìà Future: Integrate with newsletter service (Mailchimp, ConvertKit, etc.)
          console.log('Newsletter signup:', email);

          // Show success message
          const button = newsletterForm.querySelector('button');
          const originalText = button?.textContent;
          if (button) {
            button.textContent = 'Subscribed!';
            button.classList.add('bg-green-600');
            setTimeout(() => {
              button.textContent = originalText;
              button.classList.remove('bg-green-600');
            }, 3000);
          }

          // Reset form
          newsletterForm.reset();

        } catch (error) {
          console.error('Newsletter signup error:', error);
          alert('There was an error subscribing. Please try again.');
        }
      });
    }
  });
</script>